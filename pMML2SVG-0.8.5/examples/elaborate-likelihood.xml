<?xml version="1.0" encoding="utf-8"?>
<!-- Two empty lines -->
<!-- Two empty lines -->
<math xmlns="http://www.w3.org/1998/Math/MathML">
  <mstyle displaystyle="true">
    <mrow>
      <mtable>
        <mtr>
          <mtd columnalign="center">
            <mrow/>
          </mtd>
          <mtd columnalign="left">
            <mrow>
              <mi>P</mi>
              <mo stretchy="false">(</mo>
              <mtext>patches</mtext>
              <mo>&#x7C;</mo>
              <mtext>pattern&#xA0;</mtext>
              <mi>j</mi>
              <mo stretchy="false">)</mo>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd columnalign="center">
            <mrow>
              <mo>=</mo>
            </mrow>
          </mtd>
          <mtd columnalign="left">
            <mrow>
              <mi>P</mi>
              <mrow>
                <mo>(</mo>
                <mo>&#x2200;</mo>
                <mi>i</mi>
                <mo>:</mo>
                <mtable>
                  <mtr>
                    <mtd columnalign="right">
                      <mrow>
                        <msub>
                          <mrow>
                            <mi>n</mi>
                          </mrow>
                          <mrow>
                            <mi>i</mi>
                          </mrow>
                        </msub>
                      </mrow>
                    </mtd>
                    <mtd columnalign="left">
                      <mrow>
                        <mtext>&#xA0;patches of type&#xA0;</mtext>
                        <mi>i</mi>
                        <mtext>&#xA0;from pattern,</mtext>
                      </mrow>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd columnalign="right">
                      <mrow>
                        <msub>
                          <mrow>
                            <mi>n</mi>
                          </mrow>
                          <mrow>
                            <mi>I</mi>
                            <mi>i</mi>
                          </mrow>
                        </msub>
                        <mo>&#x2212;</mo>
                        <msub>
                          <mrow>
                            <mi>n</mi>
                          </mrow>
                          <mrow>
                            <mi>i</mi>
                          </mrow>
                        </msub>
                      </mrow>
                    </mtd>
                    <mtd columnalign="left">
                      <mrow>

                        <mtext>&#xA0;patches of type&#xA0;</mtext>

                        <mi>i</mi>
                        <mtext>&#xA0;from noise</mtext>
                      </mrow>
                    </mtd>
                  </mtr>
                </mtable>
                <mo>&#x7C;</mo>
                <mtext>pattern&#xA0;</mtext>
                <mi>j</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd columnalign="center">
            <mrow>
              <mo>=</mo>
            </mrow>
          </mtd>
          <mtd columnalign="left">
            <mrow>
              <mrow>
                <munder>
                  <mo>&#x220F;</mo>
                  <mrow>
                    <mi>i</mi>
                  </mrow>
                </munder>
              </mrow>
              <mi>P</mi>
              <msup>
                <mrow>
                  <mo>(</mo>
                  <mtext>patch of type&#xA0;</mtext>
                  <mi>i</mi>
                  <mo>&#x7C;</mo>
                  <mtext>pattern&#xA0;</mtext>
                  <mi>j</mi>
                  <mo>)</mo>
                </mrow>
                <mrow>
                  <msub>
                    <mrow>
                      <mi>n</mi>
                    </mrow>
                    <mrow>
                      <mi>i</mi>
                    </mrow>
                  </msub>
                </mrow>
              </msup>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd columnalign="center">
            <mrow/>
          </mtd>
          <mtd columnalign="left">
            <mrow>
              <mrow>
                <munder>
                  <mo>&#x220F;</mo>
                  <mrow>
                    <mi>i</mi>
                  </mrow>
                </munder>
              </mrow>
              <mi>P</mi>
              <msup>
                <mrow>
                  <mo>(</mo>
                  <mtext>patch of type&#xA0;</mtext>
                  <mi>i</mi>
                  <mo>&#x7C;</mo>
                  <mtext>noise</mtext>
                  <mo>)</mo>
                </mrow>
                <mrow>
                  <msub>
                    <mrow>
                      <mi>n</mi>
                    </mrow>
                    <mrow>
                      <mi>I</mi>
                      <mi>i</mi>
                    </mrow>
                  </msub>
                  <mo>&#x2212;</mo>
                  <msub>
                    <mrow>
                      <mi>n</mi>
                    </mrow>
                    <mrow>
                      <mi>i</mi>
                    </mrow>
                  </msub>
                </mrow>
              </msup>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd columnalign="center">
            <mrow>
              <mo>=</mo>
            </mrow>
          </mtd>
          <mtd columnalign="left">
            <mrow>
              <mrow>
                <munder>
                  <mo>&#x220F;</mo>
                  <mrow>
                    <mi>i</mi>
                  </mrow>
                </munder>
              </mrow>
              <mrow>
                <mo>(</mo>
                <msubsup>
                  <mrow>
                    <mi>p</mi>
                  </mrow>
                  <mrow>
                    <mi>i</mi>
                    <mi>j</mi>
                  </mrow>
                  <mrow>
                    <msub>
                      <mrow>
                        <mi>n</mi>
                      </mrow>
                      <mrow>
                        <mi>i</mi>
                      </mrow>
                    </msub>
                  </mrow>
                </msubsup>
                <msubsup>
                  <mrow>
                    <mi>p</mi>
                  </mrow>
                  <mrow>
                    <mi>i</mi>
                    <mi>X</mi>
                  </mrow>
                  <mrow>
                    <msub>
                      <mrow>
                        <mi>n</mi>
                      </mrow>
                      <mrow>
                        <mi>I</mi>
                        <mi>i</mi>
                      </mrow>
                    </msub>
                    <mo>&#x2212;</mo>
                    <msub>
                      <mrow>
                        <mi>n</mi>
                      </mrow>
                      <mrow>
                        <mi>i</mi>
                      </mrow>
                    </msub>
                  </mrow>
                </msubsup>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mrow>
  </mstyle>
</math>